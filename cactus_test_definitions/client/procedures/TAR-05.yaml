Description: Capabilities and settings - storage
Category: Monitoring
Classes:
  - L

TargetVersions:
  - v1.3-beta/storage

Preconditions:
  immediate_start: true  # There will be no "init" phase - all interactions will be immediately logged against the test
  init_actions:
    - type: set-comms-rate
      parameters:
        dcap_poll_seconds: 60
        edev_list_poll_seconds: 60
        fsa_list_poll_seconds: 60
        der_list_poll_seconds: 60
        derp_list_poll_seconds: 60
        mup_post_seconds: 60

Criteria:
  checks:
    - type: all-steps-complete
      parameters: {}
    - type: der-capability-contents
      parameters: 
         rtgMaxVA: true # Maximum apparent power
         rtgMaxVar: true # Maximum reactive power delivered
         rtgMaxVarNeg: true # Maximum reactive power received
         rtgMaxW: true # Maximum active power
         rtgMinPFOverExcited: true # Minimum power factor displacement
         rtgMinPFUnderExcited: true # Minimum power factor displacement
         doeModesSupported: true # CSIP-Aus DOE modes supported
         "rtgMaxChargeRateW": "$(this > 0)"
         "rtgMaxDischargeRateW": "$(this > 0)"
         "rtgMaxWh": "$(this > 0)"
         "vppModesSupported": "$((int(this, 16) & 0x1) == 1)"
    - type: der-settings-contents
      parameters: 
        setMaxVA: true # Maximum apparent power
        setMaxVar: true # Maximum reactive power delivered
        setMaxVarNeg: true # Maximum reactive power received
        setMaxW: true # Maximum active power
        setMinPFOverExcited: true # Minimum power factor displacement
        setMinPFUnderExcited: true # Minimum power factor displacement
        doeModesEnabled: true # CSIP-Aus DOE modes supported
        "setMaxChargeRateW": "$(this > 0)"
        "setMaxDischargeRateW": "$(this > 0)"
        "setMaxWh": "$(this > 0)"
        setMinWh: true 
        "vppModesEnabled": "$((int(this, 16) & 0x1) == 1)"
